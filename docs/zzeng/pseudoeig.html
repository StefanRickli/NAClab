<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>Pseudo-eigenvalue computation</title></head>
<body><div style="text-align: left;"><big style="font-weight: bold;"><big>Sensitivity and Computation of a Defective Eigenvalue</big></big></div><br>This website is set up to provide source codes and test results for the Algorithm PseudoEig developed in the paper <big><span style="font-style: italic;"><a href="Papers/eigit.pdf">Sensitivity and Computation of a Defective Eigenvalue</a> &nbsp;</span>by &nbsp;Zhonggang Zeng<br></big><br><br><big><big><span style="font-weight: bold;">Matlab m-files for Algorithm PseudoEig</span></big></big><small>:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</small><big><a href="pseudoeig/PseudoEig.m">PseudoEig.m</a>, &nbsp; <a href="pseudoeig/peigmap.m">peigmap.m</a>, &nbsp;<a href="pseudoeig/peigjac.m">peigjac.m</a>, <a href="pseudoeig/PEigRefine.m">PEigRefine.m</a></big><small> &nbsp; &nbsp;</small><big>(The <a href="https://web.archive.org/web/20200222192457/http://homepages.neiu.edu/%7Enaclab/">NAClab package</a> is required )</big><br><br><br><big><big><span style="font-weight: bold;">Nevigating in this page:</span></big></big><br><ul><li><a href="#Intuitive_implementation">Intuitive implementation of PseudoEig</a></li><li><a href="#Examples">Examples of using PseudoEig and PEigRefine</a></li><li><a href="#Special_structure">Special structure of the Jacobian matrix</a></li><li><a href="#Example_1_id"><small><small><big><big>Example 1. &nbsp;Identifying the multiplicity support:</big></big></small></small></a></li><li><a href="#Example_2._Refine">Example 2. &nbsp;Refine the pseudo-eigenvalue by orthogonalization</a></li><li><a href="#Example_3">Example 3. &nbsp;Refine pseudo-eigenvalue on a perturbed matrix</a></li><li><a href="#Contradicting_sensitivity">Example 4: &nbsp;Contradicting sensitivity measures of the same eigenvalue</a></li></ul><br><br><h2><a name="Intuitive_implementation"></a>Intuitive implementation of Algorithm PseudoEig&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using NAClab</h2><small><br></small><big>The <a href="https://web.archive.org/web/20200222192457/http://homepages.neiu.edu/%7Enaclab/">NAClab package</a> (Numerical Algebraic Computing laboratory) provides a quick and intuitive platform for implementing Algorithm PseudoEig.<br><br>For details of the algorithm and its theory, see the preprint &nbsp;<span style="font-style: italic;"><a href="Papers/eigit.pdf">Sensitivity and Computation of a Defective Eigenvalue</a> &nbsp;</span>by &nbsp;Zhonggang Zeng<br><br>A short sketch of the algorithm is a follows. </big><br><br><img style="width: 680px; height: 510px;" alt="Method sketch" src="https://web.archive.org/web/20200222192457im_/http://homepages.neiu.edu/~zzeng/pseudoeig/MethodSketch.jpg"><br><big>NAClab provides an intuitive and straightforward platform to implement such an algorithm. &nbsp;Just follow the steps below.<br></big><big><br>Step 1. &nbsp;Download and install  <a href="https://github.com/StefanRickli/NAClab/blob/main/NAClab.zip">NAClab package</a></big><small><br><br></small><big>Step 2. Write a Matlab function for the mapping <span style="font-weight: bold;">g</span> and save it as <a href="pseudoeig/peigmap.m">peigmap.m</a></big><small> , </small><big>which is almost WYSIWYG.</big><small><br><br></small><big>Step 3. &nbsp;Write a Matlab function for the Jacobian linear transformation and save it as <a href="pseudoeig/peigjac.m">peigjac.m</a></big><small>, </small><big>which is also almost WYSIWYG.</big><small><br><br></small><big>Step 4. &nbsp;Write the main function PseudoEig and save it as <a href="pseudoeig/PseudoEig.m">PseudoEig.m</a>, &nbsp; where the Gauss-Newton iteration is calling the generic module GaussNewton.m in NAClab in a single line<br><br>[Z,res,lcond] = GaussNewton({@peigmap,{1,ones(n,k)},{A,C,S}}, @peigjac, {lambda0,X0},1);<br><br>By design, the generic module GaussNewton expects input items <br>&nbsp; &nbsp;--- the cell includes &nbsp;(i) &nbsp;the Matlab function handle for the mapping, i.e. &nbsp;<span style="font-weight: bold;">@peigmap</span><br>&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(ii) &nbsp;the domain C
x C^{n x k} represented by the cell, i.e. <span style="font-weight: bold;">{1, ones(n,k)}</span><br>&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (iii) &nbsp;the parameters
for the mapping in the cell, i.e.&nbsp; <span style="font-weight: bold;">{A,C,S}</span><br>&nbsp; &nbsp;--- the Matlab function handle for the Jacobian linear transformation, i.e. &nbsp;<span style="font-weight: bold;"> @peigjac</span><br>&nbsp; &nbsp;--- the initial iterate cell, i.e. &nbsp;<span style="font-weight: bold;">{lambda0, X0}</span><br>&nbsp; &nbsp;--- the optional tracking flag, 0 or 1, <br>The output Z is the cell whose first component is the pseudo eigenvalue and the second is the X.<br></big><br><br><span style="font-weight: bold;"><a name="Examples"></a>Examples of using PseudoEig and PEigRefine</span><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Installation of NAClab is required to repeat the examples)<br><ul><li><a href="#Example_1">Example 1</a>: &nbsp; Using PseudoEig, including finding the multiplicity support</li><li><a href="#Example_2">Example 2</a>. &nbsp; Refine the pseudo-eigenvalue</li></ul><br><br><a name="Example_1"></a>Example 1. &nbsp;Using PseudoEig, including finding the multiplicity support<br><br>NAClab function "MatrixWithGivenJordanForm" is convenient in quick construction of testing matrices:<br><br><small><small><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; [A,U,V] = MatrixWithGivenJordanForm([2,3],{[4,3],[2 2]});</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; A</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">A =</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0<br>&nbsp;&nbsp;&nbsp;
-2&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0<br>&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0<br>&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0<br>&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp; -1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; -1<br>&nbsp;&nbsp;&nbsp;
-4&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
3&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;
3&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0<br>&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 1<br>&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0<br>&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0<br>&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp; 1<br>&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;
-1&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
-2&nbsp;&nbsp;&nbsp;&nbsp; 5</span></small></small><br><br>Apply conventional eigen-finder for initial eigenvalues:<br><br><small><small><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; eig(A)</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">ans =</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 3.000000000000003 + 0.000000063443468i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 3.000000000000003 - 0.000000063443468i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 2.999999999999997 + 0.000000021680931i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 2.999999999999997 - 0.000000021680931i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 2.000131207566168 + 0.000131197500271i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 2.000131207566168 - 0.000131197500271i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 2.000003852182530 + 0.000006672920661i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 2.000003852182530 - 0.000006672920661i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 1.999992295634929 + 0.000000000000000i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 1.999868792433838 + 0.000131217576475i</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp; 1.999868792433838 - 0.000131217576475i</span></small></small><br><br>Pick an approximate eigenvalue, say <span style="font-family: Courier New; color: rgb(0, 0, 153);">1.999868792433838 + 0.000131217576475i</span>, Find the geometric multiplicity by SVD:<br><br><small><small><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; svd(A-(1.999868792433838 + 0.000131217576475i)*eye(size(A)))</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">ans =</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 7.486664684066285</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 5.573841967969352</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 3.961701858109521</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 2.441112093740693</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 2.253848558674539</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 0.773876810987828</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 0.652336598832444</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 0.341709210710030</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 0.089726975408410</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 0.000000000002225</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 0.000000000000000</span></small></small><br><br>Clearly,
the geometric multiplicity is 2. &nbsp; We can then determine the Segre
anchor k by trial and error. &nbsp;Start with, say k=2:<br><br><small><small><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; [lambda,X,C,S,res,lcond] = PseudoEig(A,1.999868792433838 + 0.000131217576475i,2,2);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.82e-08 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 6.38e-09 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.66e-09 <br>&gt;&gt; res,lcond<br>res =<br>&nbsp;&nbsp;&nbsp;&nbsp; 1.800832453591654e-11<br>lcond =<br>&nbsp;&nbsp;&nbsp;&nbsp; 9.970824679378054e+08</span><span style="font-family: Courier New; color: rgb(0, 0, 153);"></span></small></small><br><br>Tiny residual and large condition number means k=2 underestimates the Segre anchor. &nbsp;So increase it to k=3:<br><br><small><small><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; [lambda,X,C,S,res,lcond] = PseudoEig(A,1.999868792433838 + 0.000131217576475i,2,3);</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 2.02e-07 </span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 6.93e-14 </span>&nbsp; ...<br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; res, lcond</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">res =</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp;&nbsp;&nbsp; 2.775557561562891e-16</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">lcond =</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp;&nbsp;&nbsp; 4.162970862477419e+03</span></small></small><br><br>It appears that k=3 is the correct Segre anchor, the pseudo-eigenvalue<br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt; lambda</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">lambda =</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000000000000000 - 0.000000000000000i</span></small></small><br><br>The
pseodo-eigenvalue approximates the exact eigenvalue to the last digit.
&nbsp;To confirm the Segre anchor, try increasing it to k=4:<br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt; [lambda,X,C,S,res,lcond] = PseudoEig(A,1.999868792433838 + 0.000131217576475i,2,4);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.35e-02 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 5.11e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 7.20e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 4:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.24e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 5:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.14e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 6:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.14e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 7:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.13e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 8:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.14e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 9:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.14e-05 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp; 10:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.14e-05 </span></small></small><br><br>The
residual increased dramatically from 1e-16 to 1e-5, confirming k=4 is
an overestimation of the Segre anchor. &nbsp;Since the norm of the
Moore-Penrose inverse of X is small, no refinement is needed:<br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt; norm(pinv(X))</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 2.649718399297023</span></small></small><br><br><a name="Example_2"></a>Example 2. &nbsp;Refine the pseudo-eigenvalue<br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt;
A =&nbsp;&nbsp; [
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12];</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; [lambda,X,C,S,res,lcond] = PseudoEig(A,1.9998,1,5);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 7.54e-07 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 7.62e-13 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 8.60e-14 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 4:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.20e-13 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 5:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 9.32e-14 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 6:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 8.96e-14 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; lambda</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">lambda =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 1.999999999992827</span></small></small><br><br>The backward error is not small enough:<br><br><small style="font-family: Courier New; color: rgb(0, 0, 153);"><small>&gt;&gt; res*norm(pinv(X))<br>ans =<br>&nbsp;&nbsp;&nbsp;&nbsp; 5.018090688429607e-08</small></small><br><br>Apply PEigRefine to refine the result:<br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt; lambda0 = lambda;&nbsp; C0 = C; S0 = S; X0 = X;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; [lambda,X,C,S,res,lcond] = PEigRefine(A,lambda0,X0,C0,S0)</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.82e-12 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.82e-12 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.90e-14 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 4:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.82e-12 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 5:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.82e-12 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 6:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.82e-12 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; lambda</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">lambda =</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 2</span></small></small><br><br>The refined backward error is now tiny:<br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt; res*norm(pinv(X))</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 1.901074022838812e-14</span></small></small><br><br><big><a name="Special_structure"></a><big><span style="font-weight: bold;">Special structure of the Jacobian matrix</span></big></big><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;The Matlab function &nbsp;<a href="pseudoeig/peigmat.m">peigmat.m</a>
&nbsp;rearranges the Jacobian matrix in to a near upper triangular
form, making it possible to take advantage of the structure to improve
efficiency. <br><br>Without loss of generality, assume the matrix is in Hessenberg form. &nbsp;For a 100x100 matrix A, 100x3 matrix C, &nbsp;3x3 S:<br><br><small><small><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; M = peigmat(lambda,X,A,C,S);</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; size(M)</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">ans =</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&nbsp;&nbsp; 159&nbsp;&nbsp; 151</span><br style="font-family: Courier New; color: rgb(0, 0, 153);"><br style="font-family: Courier New; color: rgb(0, 0, 153);"><span style="font-family: Courier New; color: rgb(0, 0, 153);">&gt;&gt; spy(M)</span></small></small><br><br><img style="width: 590px; height: 442px;" alt="Sturectur of Jacobian" src="https://web.archive.org/web/20200222192457im_/http://homepages.neiu.edu/~zzeng/pseudoeig/Jacmat.jpg"><br><br><br><br><br><a name="Contradicting_sensitivity"></a>Example 4: &nbsp;Contradicting sensitivity measures of the same eigenvalue<br><br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt; A = [1503/500,2,201/200,-1001/1000,-1/500,-1/1000,-1/1000,-1;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">5,2,5,-1,-2,-1,-1,0;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">-2503/500,-3,-601/200,2001/1000,1501/500,2001/1000,1/1000,2;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">-6,-1,-6,3,5,3,0,1;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">-5,-1,-5,1,6,3,0,1;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">1,0,1,0,-1,1,0,0;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">-4,-2,-4,1,3,2,2,2;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">5,0,5,-1,-2,-1,-1,2]</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; e = eig(A)</span></small></small><small><small><br style="font-family: Courier New;"><span style="font-family: Courier New;">e =</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.001415092944351 + 0.002122713121581i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.001415092944351 - 0.002122713121581i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.998908958350295 + 0.002124009818083i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.998908958350295 - 0.002124009818083i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.002684635776857 + 0.000000000000000i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.997667261633844 + 0.000000000000000i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000000055770595 + 0.000000000000000i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.999999944229407 + 0.000000000000000i</span><br style="font-family: Courier New;"></small></small><br><br>By PseudoEig<br><br><small style="color: rgb(0, 0, 153);"><small><span style="font-family: Courier New;">&gt;&gt; [lambda,X,C,S,res,lcond] = PseudoEig(A,e(1),2,2);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 9.84e-06 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 9.82e-11 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 6.38e-16 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 4:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 5.96e-16 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 5:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 4.44e-16 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 6:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 5.15e-16 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 7:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 5.05e-16 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 8:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 9.33e-16 </span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; lambda, lcond</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">lambda =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000000000000000 - 0.000000000000000i</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">lcond =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 3.304315987763452e+02</span><br style="font-family: Courier New;"></small></small><br>The
2x2 condition number is manageable at 3.3e+02, while the sensitivity
measured by spectral projector norm is huge at&nbsp; 4.4e14<br><br>NAClab function NumericalJordanForm calculates the numerical Jordan Canonical Form<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; [J,X,e,s,t] = NumericalJordanForm(A,1e-9);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; format short</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; J</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">J =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;
2.0028&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp; 2.0000&nbsp;&nbsp;
-0.8321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
2.0000&nbsp;&nbsp;&nbsp;
0.2536&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
2.0000&nbsp;&nbsp;
-1.1073&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
2.0000&nbsp;&nbsp;&nbsp;
5.2368&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
2.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
2.0000&nbsp;&nbsp; -5.3852</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;
2.0000</span></small></small><br><br><br>With a high overall condition number<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; cond(X)</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 5.0956e+13</span></small></small><br><br>even though the Jordan structure for the eigenvalue 2.00000000000 is not highly sensitive <br><br><small><small><span style="font-family: Courier New;">&gt;&gt; t(2,2)</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 178.2683</span></small></small><br><br>If we use a loose error tolerance 1e-5, the numerical Jordan form becomes<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; [J,X,e,s,t] = NumericalJordanForm(A,1e-5);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; single(J)</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;
2.0001249&nbsp;&nbsp;
0.4962730&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp; 2.0001249&nbsp;&nbsp;
0.8362637&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp; 2.0001249&nbsp;
-0.3181596&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp; 2.0001249&nbsp;&nbsp;
1.1284051&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp; 2.0001249&nbsp;
18.9835510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;
2.0001249&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp; 2.0001249&nbsp;&nbsp; 5.3860307</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp; 2.0001249</span></small></small><br><br>The residual is within the error tolerance and condition number is not large:<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; t(1), t(2)</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 2.128714409525071e-06</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 1.590906220366132e+02</span><br style="font-family: Courier New;"><br><big><big></big></big><br><big><big><span style="font-weight: bold;"><a name="Example_1_id"></a>Example 1. &nbsp;Identifying the multiplicity support:<br><br><small><small style="font-family: Courier New;"><small>&gt;&gt; A<br><br>A =<br><br>&nbsp;
0&nbsp;&nbsp; 4&nbsp;&nbsp; 0&nbsp;
-4&nbsp;&nbsp; 0&nbsp;
-2&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp; -1&nbsp;
-1&nbsp; -1&nbsp; -1&nbsp;&nbsp;
2&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp; 0<br>&nbsp;&nbsp;0&nbsp;&nbsp; 3&nbsp;&nbsp; 3&nbsp;
-4&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 4&nbsp;&nbsp; 1&nbsp;
-1&nbsp; -1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;
-2&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp; -1&nbsp; -1<br>&nbsp;
1&nbsp;&nbsp;-4&nbsp;&nbsp; 2&nbsp;
10&nbsp; -3&nbsp;&nbsp; 1&nbsp;
-7&nbsp; -2&nbsp; -1&nbsp;&nbsp;
3&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
3&nbsp; -1&nbsp;&nbsp;
1&nbsp;&nbsp; 1&nbsp;&nbsp; 2<br>&nbsp;-1&nbsp;&nbsp;-1&nbsp;&nbsp;
2&nbsp;&nbsp; 5&nbsp; -2&nbsp;
-1&nbsp; -5&nbsp; -1&nbsp;
-1&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp; -1&nbsp;&nbsp;
0&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 2&nbsp; -1&nbsp;
-1&nbsp; -1&nbsp;&nbsp; 1<br>&nbsp;-1&nbsp;&nbsp;-2&nbsp;&nbsp;
2&nbsp;&nbsp; 1&nbsp;&nbsp;
1&nbsp;&nbsp; 1&nbsp;
-1&nbsp;&nbsp; 0&nbsp;
-2&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp; -1&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp; 0<br>&nbsp;
1&nbsp;&nbsp; 4&nbsp;&nbsp; 1
-12&nbsp;&nbsp; 4&nbsp;&nbsp;
2&nbsp; 13&nbsp;&nbsp;
3&nbsp;&nbsp; 0&nbsp;
-4&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp; -2&nbsp; -1&nbsp;&nbsp;
1&nbsp; -6&nbsp;&nbsp;
1&nbsp;&nbsp; 1&nbsp;&nbsp; 0&nbsp;
-3<br>&nbsp;-1&nbsp;&nbsp;-1&nbsp;&nbsp;
1&nbsp;&nbsp; 5&nbsp;
-2&nbsp;&nbsp; 0&nbsp; -4&nbsp;
-2&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp; -1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;&nbsp;
4&nbsp;&nbsp; 0&nbsp; -1&nbsp;
-1&nbsp;&nbsp; 2<br>&nbsp;
1&nbsp;&nbsp; 2&nbsp;&nbsp;-4&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp;&nbsp; 1&nbsp;&nbsp; 4&nbsp;
-2&nbsp; -1&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp;&nbsp; 2&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;&nbsp; 1<br>&nbsp;
0&nbsp;&nbsp;-5&nbsp;&nbsp; 2&nbsp;
10&nbsp; -5&nbsp; -1
-10&nbsp; -2&nbsp; -1&nbsp;&nbsp;
6&nbsp;&nbsp; 3&nbsp;
-2&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp; 3&nbsp;
-3&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp;&nbsp; 2<br>&nbsp;
1&nbsp;&nbsp; 1&nbsp;&nbsp; 1&nbsp;
-1&nbsp;&nbsp; 2&nbsp;&nbsp;
2&nbsp;&nbsp; 4&nbsp;&nbsp;
0&nbsp;&nbsp; 1&nbsp; -1&nbsp;
-1&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp; -1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
2&nbsp;&nbsp; 1&nbsp;
-1&nbsp;&nbsp; 0<br>&nbsp;
1&nbsp;&nbsp;-1&nbsp;&nbsp;
0&nbsp;&nbsp; 2&nbsp;&nbsp;
1&nbsp;&nbsp; 2&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;&nbsp; 1&nbsp;
-1&nbsp;&nbsp; 3&nbsp;&nbsp;
2&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 1&nbsp;&nbsp; 1&nbsp;
-1&nbsp;&nbsp; 0<br>&nbsp;-1&nbsp;&nbsp;-3&nbsp;&nbsp;
0&nbsp;&nbsp; 5&nbsp;
-1&nbsp;&nbsp; 2&nbsp; -4&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp; -1&nbsp;&nbsp;
4&nbsp;&nbsp; 4&nbsp;&nbsp; 1&nbsp;
-2&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp; -1&nbsp;&nbsp;
0&nbsp;&nbsp; 1<br>&nbsp;-2&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp; -1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
3&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp; 0<br>&nbsp;-3&nbsp;&nbsp; 4&nbsp;&nbsp;-1&nbsp;
-4&nbsp;&nbsp; 0&nbsp;
-2&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp; -1&nbsp;
-1&nbsp; -1&nbsp; -2&nbsp;&nbsp;
5&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 1&nbsp;&nbsp; 0<br>&nbsp;-2&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp; -1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 2&nbsp;&nbsp;
3&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp; 0<br>&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;-2&nbsp;&nbsp; 3&nbsp;&nbsp;
1&nbsp;&nbsp; 2&nbsp; -1&nbsp;
-1&nbsp;&nbsp; 2&nbsp; -2&nbsp;
-2&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 5&nbsp;&nbsp;
2&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 1<br>&nbsp;
6&nbsp;&nbsp; 3&nbsp;&nbsp;-6&nbsp;&nbsp; 3&nbsp;&nbsp;
6&nbsp;&nbsp; 4&nbsp;&nbsp;
7&nbsp;&nbsp; 0&nbsp;&nbsp; 7&nbsp;
-7&nbsp;&nbsp; 1&nbsp;&nbsp;
5&nbsp; -2&nbsp; -6&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;&nbsp;
8&nbsp;&nbsp; 6&nbsp;
-1&nbsp;&nbsp; 0<br>&nbsp;
0&nbsp;&nbsp; 2&nbsp;&nbsp;-4&nbsp;
-4&nbsp;&nbsp; 1&nbsp;
-1&nbsp;&nbsp; 4&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp; -1&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp; -2&nbsp;&nbsp;
0&nbsp;&nbsp; 3&nbsp;&nbsp; 4&nbsp;
-1<br>&nbsp;
1&nbsp;&nbsp;-4&nbsp;&nbsp;-1&nbsp;
11&nbsp; -4&nbsp;&nbsp; 1&nbsp;
-8&nbsp; -3&nbsp; -1&nbsp;&nbsp;
3&nbsp;&nbsp; 2&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;
-1&nbsp;&nbsp; 0&nbsp;&nbsp;
4&nbsp; -1&nbsp;&nbsp;
1&nbsp;&nbsp; 4&nbsp;&nbsp; 3<br>&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;-1&nbsp;&nbsp; 1&nbsp;
-2&nbsp;&nbsp; 0&nbsp; -1&nbsp;
-2&nbsp;&nbsp; 1&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp;&nbsp; 0&nbsp;&nbsp;
0&nbsp;&nbsp; 0&nbsp;&nbsp; 4</small></small></small><br style="font-family: Courier New;"></span></big></big><br style="font-family: Courier New;"></small></small>Use the Matlab eig to find eigenvalue estimates:<br><br><small><small><span style="font-family: Courier New;">&gt;&gt;  diag(D)</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 3.001426431341224 + 0.000000000000000i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 3.000624722484589 + 0.000453755506064i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 3.000624722484589 - 0.000453755506064i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 3.000440399461022 + 0.001356489469455i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 3.000440399461022 - 0.001356489469455i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.999761500834580 + 0.000734576671243i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.999761500834580 - 0.000734576671243i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.998846384868383 + 0.000837895621509i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.998846384868383 - 0.000837895621509i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.999227553361644 + 0.000000000000000i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.999831389084806 + 0.000168679704578i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.999831389084806 - 0.000168679704578i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000168610915185 + 0.000168542182678i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000168610915185 - 0.000168542182678i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.999989850392488 + 0.000017578122305i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.999989850392488 - 0.000017578122305i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 1.999993977339806 + 0.000000000000000i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000020299214969 + 0.000000000000000i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000003011330126 + 0.000005216432308i</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 2.000003011330126 - 0.000005216432308i</span></small></small><br><br>The
eigenvalue D(1,1) =&nbsp; 3.001426431341224 + 0.000000000000000i &nbsp;
appears to be defective since the condition number is high:<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; 1/abs(V(:,1)'*W(:,1))</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 3.096614239827069e+11</span></small></small><br><br><br>The geometric multiplicity is clearly two from the numerical nullity identified via singular values&nbsp;<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; s = svd(A-e(1)*eye(size(A)))</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">s =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 40.024122556006361</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 22.819868881416550</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; 11.340731455999819</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 9.397825324315559</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 6.260902607815194</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 4.358978843241264</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 3.295092277976436</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 2.208518179170260</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 2.014640549400185</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 1.237827273324948</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.661297941705164</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.546549612836940</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.316193846463476</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.194202964265260</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.108370106835163</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.070055683229182</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.054676439994994</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.036243966725033</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.000000000000002</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.000000000000001</span></small></small><br><br>To identify the Segre anchor k, &nbsp;run PseudoEig with k = 1, 2, ...<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; for k = 1:6, [lambda,X,C,S,res,lcond] = PseudoEig(A,e(1),2,k); disp([k,res,lcond]); end</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;
2.000000000000000e+00&nbsp;&nbsp;&nbsp;&nbsp;
1.467949463967694e-13&nbsp;&nbsp;&nbsp;&nbsp; 4.632744825087318e+14</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;
3.000000000000000e+00&nbsp;&nbsp;&nbsp;&nbsp;
1.245977341450316e-10&nbsp;&nbsp;&nbsp;&nbsp; 1.515278877406559e+10</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;
4.000000000000000e+00&nbsp;&nbsp;&nbsp;&nbsp;
2.365260962187022e-09&nbsp;&nbsp;&nbsp;&nbsp; 3.476672400527993e+09</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;
5.000000000000000e+00&nbsp;&nbsp;&nbsp;&nbsp;
1.390184611834986e-15&nbsp;&nbsp;&nbsp;&nbsp; 5.791114059263334e+04</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;
6.000000000000000e+00&nbsp;&nbsp;&nbsp;&nbsp;
2.622216751629970e-03&nbsp;&nbsp;&nbsp;&nbsp; 1.114112133754904e+05</span></small></small><br><br>The Segre anchor is &nbsp;k = 5.<br><br>&gt;&gt; [lambda,X,C,S,res,lcond] = PseudoEig(A,e(1),2,5);<br>&gt;&gt; lambda<br><br>lambda =<br><br>&nbsp;&nbsp;&nbsp;&nbsp; 3.000000000000086e+00<br><br><br><big style="font-weight: bold;"><a name="Example_2._Refine"></a>Example 2. &nbsp;Refine the pseudo-eigenvalue by orthogonalization</big><br><br><br>By PseudoEig, &nbsp;we get an approximate value of the eigenvalue<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; A</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">A =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; [lambda,X,C,S,res,lcond] = PseudoEig(A,1.999,1,5);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; lambda</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">lambda =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 1.999999999997139e+00</span><br style="font-family: Courier New;"></small></small><br style="font-family: Courier New;"><span style="font-family: Courier New;">The backward error:</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><small><small><span style="font-family: Courier New;">&gt;&gt; res*norm(pinv(X))</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 3.671544140185711e-08</span></small></small><br><br>Refine the pseudo-eigenvalue by orthogonalization:<br><br><br><small><small><span style="font-family: Courier New;">&gt;&gt; lambda0 = lambda; X0 = X; C0 = C; S0 = S;</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; [lambda,X,C,S,res,lcond] = PEigRefine(A,lambda0,X0,C0,S0);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; lambda</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">lambda =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 2</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; res*norm(pinv(X))</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp; 2.874961099398239e-14</span></small></small><br><br>The backward error is reduced to 2.9e-14 from &nbsp;3.7e-8<br><br><br><big style="font-weight: bold;"><a name="Example_3"></a>Example 3. &nbsp;Refine pseudo-eigenvalue on a perturbed matrix</big><br><br><small><small><span style="font-family: Courier New;">&gt;&gt; A</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">A =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; E</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">E =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp; -0.092000000000000&nbsp; -0.653000000000000&nbsp; -0.201000000000000&nbsp; -0.416000000000000&nbsp; -0.787000000000000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;
-0.135000000000000&nbsp; -0.218000000000000&nbsp;&nbsp;
0.054000000000000&nbsp; -0.136000000000000&nbsp; -0.255000000000000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;
0.651000000000000&nbsp;&nbsp; 0.663000000000000&nbsp;
-0.166000000000000&nbsp; -0.969000000000000&nbsp; -0.603000000000000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;
-0.833000000000000&nbsp;&nbsp; 0.607000000000000&nbsp;&nbsp;
0.314000000000000&nbsp;&nbsp; 0.969000000000000&nbsp; -0.020000000000000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;
-0.733000000000000&nbsp; -0.879000000000000&nbsp;&nbsp;
0.256000000000000&nbsp; -0.665000000000000&nbsp; -0.321000000000000</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; B = A+1e-5*E</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">B =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 1.0e+04 *</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;
0.000199999908000&nbsp;&nbsp; 0.000099999347000&nbsp;
-0.000000000201000&nbsp; -0.000000000416000&nbsp; -0.000000000787000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;
-0.000000000135000&nbsp; -0.000800000218000&nbsp;&nbsp;
0.000100000054000&nbsp; -0.000000000136000&nbsp; -0.000000000255000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp;
0.000000000651000&nbsp;&nbsp; 0.000000000663000&nbsp;&nbsp;
0.000199999834000&nbsp;&nbsp; 0.000099999031000&nbsp; -0.000000000603000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;
-0.000000000833000&nbsp;&nbsp; 0.000000000607000&nbsp;&nbsp;
0.000000000314000&nbsp;&nbsp; 0.000200000969000&nbsp;&nbsp;
0.000099999980000</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;
-0.000000000733000&nbsp; -1.000000000879000&nbsp;&nbsp;
0.100000000256000&nbsp; -0.010000000665000&nbsp;&nbsp; 0.001199999679000</span></small></small><br><br>From the estimated eigenvalue 1.99<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; [U,T,V] = svd(B-1.99*eye(5));</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">N = V(:,end);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">[lambda,X,C,S,res,lcond] = PseudoEig(B,1.99,1,5,N);</span><br style="font-family: Courier New;"><span style="font-family: Courier New;">&gt;&gt; lambda</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">lambda =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 2.004413315460551</span></small></small><br><br>Backward error<br><br><small><small><span style="font-family: Courier New;">&gt;&gt; res*norm(pinv(X))</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">ans =</span><br style="font-family: Courier New;"><br style="font-family: Courier New;"><span style="font-family: Courier New;">&nbsp;&nbsp; 0.059004303654087</span></small></small><br><br><br>Refine:<br><br><small><small>&gt;&gt; lambda0 = lambda; X0 = X; C0 = C; S0 = S;<br>&gt;&gt; [lambda,X,C,S,res,lcond] = PEigRefine(B,lambda0,X0,C0,S0);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 2.20e-02 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 1:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 1.89e-02 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 2:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 2.06e-06 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 3:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 2.06e-06 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 4:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 2.06e-06 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Step&nbsp;&nbsp; 5:&nbsp;&nbsp;&nbsp;&nbsp; residual =&nbsp;&nbsp; 2.06e-06 <br>&gt;&gt; lambda<br><br>lambda =<br><br>&nbsp;&nbsp; 1.999998778227778</small></small><br><br><br>With backward error:<br><br><small style="font-family: Courier New;"><small>&gt;&gt; res*norm(pinv(X))<br><br>ans =<br><br>&nbsp;&nbsp;&nbsp;&nbsp; 9.603166323203087e-06</small></small><br><br><br><br><br></body></html>